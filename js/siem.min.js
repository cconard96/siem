(function(){window.SIEMPlugin=function(){var self=this;this.ajax_root=CFG_GLPI.root_doc+"/plugins/siem/ajax/";this.dashboard="#siem-dashboard";$(document).ready(function(){if($(self.dashboard).length>0){self.refreshDashboard()}});var buildDashboardDeck=function(cards){$(self.dashboard).empty();var content="<div class='container-fluid content'>";content+="<h2 class='text-center'>Event Monitoring Dashboard</h2>";content+="<p class='text-center'>"+new Date+"</p>";content+="<div class='siem-decks'>";$.each(cards,function(r_index,row){content+="<div class='siem-deck card-deck'>";$.each(row,function(c_index,card){var card_classes=["siem-card","card","text-center","card-"+card.type];if(card.extra_card_classes!==undefined){card_classes.concat(card.extra_card_classes)}content+="<div class='"+card_classes.join(" ")+"'>";content+="<div class='card-header'><p class=''>"+card.title+"</p></div>";content+="<div class='card-body'>";content+=buildCardBody(card);content+="</div></div>"});content+="</div>"});content+="</div></div>";$(content).appendTo($(self.dashboard))};var buildCardBody=function(card){var content="";if(card.type==="counter"){return"<p>"+card.value+"</p>"}else if(card.type==="table"){content+="<table class='w-100'><thead>";$.each(card.headers,function(i,header){content+="<th>"+header+"</th>"});content+="</thead><tbody>";$.each(card.rows,function(i,row){content+="<tr>";$.each(row,function(i2,cell){content+="<td class='"+(cell.class||"")+"'>"+cell.value+"</td>"});content+="</tr>"});content+="</tbody></table>"}else if(card.type==="table-v"){content+="<table class='w-100'>";$.each(card.headers,function(i,header){var cell=card.rows[i];content+="<tr class='"+(cell.class||"")+"'>";content+="<th class=''text-center>"+header+"</th>";content+="<td class='text-left'>"+cell.value+"</td>";content+="</tr>"});content+="</table>"}else{return"<p>"+card.value+"</p>"}return content};self.refreshDashboard=function(){var form=$(self.dashboard+" .siem-toolbar");var get_data=form.serialize();$.ajax({type:"GET",url:self.ajax_root+"siemdashboard.php",data:get_data,success:function(cards){buildDashboardDeck(cards)}})};function toggleEventDetails(row){var id=$(row).attr("id");var content_row=$("#"+id+"_content");if(typeof content_row!==typeof undefined){var hidden_attr=content_row.attr("hidden");if(typeof hidden_attr!==typeof undefined){content_row.removeAttr("hidden")}else{content_row.attr("hidden","hidden")}}}this.updateSensorDropdown=function(plugin_dropdown,sensor_dropdown,linked_btn){var selected_plugin=$(plugin_dropdown).val();$.ajax({type:"GET",url:self.ajax_root+"getSensors.php",data:{plugins_id:selected_plugin},success:function(sensors){var sensordropdown_jobj=$(sensor_dropdown);sensordropdown_jobj.empty().select2({width:"max-content"});if(Object.keys(sensors).length>0){sensordropdown_jobj.removeAttr("disabled");$(linked_btn).removeAttr("disabled")}else{sensordropdown_jobj.attr("disabled","disabled");$(linked_btn).attr("disabled","disabled")}$.each(sensors,function(id,name){sensordropdown_jobj.append(new Option(name,id,false,false))});sensordropdown_jobj.trigger("change")}})};function serviceCheckNow(services_id){}function hostScheduleDowntime(hosts_id){}function serviceScheduleDowntime(services_id){}function addService(){}};window.pluginSiem=new SIEMPlugin})();