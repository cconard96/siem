(function(){window.SIEMPlugin=function(){var b=this;this.ajax_root=CFG_GLPI.root_doc+"/plugins/siem/ajax/";this.dashboard="#siem-dashboard";$(document).ready(function(){});this.toggleEventDetails=function(g){var h=$(g).attr("id");var f=$("#"+h+"_content");if(typeof f!==typeof undefined){var e=f.attr("hidden");if(typeof e!==typeof undefined){f.removeAttr("hidden")}else{f.attr("hidden","hidden")}}};this.updateSensorDropdown=function(h,f,e){var g=$(h).val();$.ajax({type:"GET",url:b.ajax_root+"getSensors.php",data:{plugins_id:g},success:function(j){var i=$(f);i.empty().select2({width:"max-content"});if(Object.keys(j).length>0){i.removeAttr("disabled");$(e).removeAttr("disabled")}else{i.attr("disabled","disabled");$(e).attr("disabled","disabled")}$.each(j,function(l,k){i.append(new Option(k,l,false,false))});i.trigger("change")}})};this.hostCheckNow=function(e){$.ajax({type:"POST",url:b.ajax_root+"siemhost.php",data:{_check_now:true,hosts_id:e}})};function a(e){}function c(e){}function d(e){}this.addHostService=function(e){$.ajax({type:"GET",url:b.ajax_root+"getSiemServiceTemplates.php",data:{},success:function(f){$("<div id='add-host-form'><select class='service-template-dropdown'></select></div>").dialog({modal:true,title:"Add service from template",open:function(){var g=$("#add-host-form .service-template-dropdown");g.empty().select2({width:"max-content"});if(Object.keys(f).length>0){g.removeAttr("disabled")}else{g.attr("disabled","disabled")}$.each(f,function(i,h){g.append(new Option(h,i,false,false))});g.trigger("change")},buttons:{Add:function(){var h=$(this);var g=$("#add-host-form").find("select").select2("val");$.ajax({type:"POST",url:b.ajax_root+"siemhost.php",data:{_add_service:true,hosts_id:e,servicetemplates_id:g},complete:function(){h.dialog("close")}})}}})}})}};window.pluginSiem=new SIEMPlugin()})();